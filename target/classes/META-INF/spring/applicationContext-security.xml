<?xml version="1.0" encoding="UTF-8"?>
<beans:beans xmlns="http://www.springframework.org/schema/security" 
    xmlns:beans="http://www.springframework.org/schema/beans" 
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
    xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.1.xsd
        http://www.springframework.org/schema/security http://www.springframework.org/schema/security/spring-security-3.1.xsd">
    <!-- HTTP security configurations auto-config="true" -->
    <http  use-expressions="true" auto-config="false" entry-point-ref="http403EntryPoint">
        <!-- <form-login login-processing-url="/resources/j_spring_security_check" login-page="/login"  authentication-failure-url="/login?login_error=t"  authentication-success-handler-ref="authenticationSuccessHandler" />
        <form-login login-processing-url="/resources/j_pda_check"  default-target-url="/cwborderPDA?requestpara=userlogin"  authentication-failure-url="/cwborderPDA/loginError"  authentication-success-handler-ref="authenticationSuccessHandler" />
         --><session-management session-authentication-strategy-ref=""><concurrency-control /></session-management>
        <logout logout-url="/resources/j_spring_security_logout" />
        <!-- Configure these elements to secure URIs in your application -->
        <intercept-url pattern="/choices/**" access="hasRole('ROLE_ADMIN')" />
        <intercept-url pattern="/member/**" access="isAuthenticated()" />
        <intercept-url pattern="/resources/**" access="permitAll" />
        <intercept-url pattern="/login" access="permitAll" />
        <intercept-url pattern="/monitor/**" access="permitAll" />
        <intercept-url pattern="/monitor*/**" access="permitAll" />
        <intercept-url pattern="/monitordelivery/**" access="permitAll" />
        <intercept-url pattern="/order/**" access="permitAll" />
        <intercept-url pattern="/complaint/**" access="permitAll" />
        <intercept-url pattern="/exportcwb/**" access="permitAll" />
        <intercept-url pattern="/delivery/**" access="permitAll" />
        <intercept-url pattern="/funds/**" access="permitAll" />
        <intercept-url pattern="/cleint/**" access="permitAll" />
        <intercept-url pattern="/sysetem/**" access="permitAll" />
        <intercept-url pattern="/problem/**" access="permitAll" />
        <intercept-url pattern="/news/**" access="permitAll" />
        <intercept-url pattern="/proxy/**" access="permitAll" />
        <intercept-url pattern="/sms/**" access="permitAll" />
        <intercept-url pattern="/smsconfig/**" access="permitAll" />
        <intercept-url pattern="/interface/**" access="permitAll" />
        <intercept-url pattern="/pospay/**" access="permitAll" />
        <intercept-url pattern="/createselectterm/**" access="permitAll" />
        <intercept-url pattern="/js/**" access="permitAll" />
        <intercept-url pattern="/css/**" access="permitAll" />
        <intercept-url pattern="/common/**" access="permitAll" />
        <intercept-url pattern="/images/**" access="permitAll" />
        <intercept-url pattern="/advancedquery/**" access="permitAll" />
        <intercept-url pattern="/cwborderPDA/loginError" access="permitAll" />
        <intercept-url pattern="/interface/**" access="permitAll" />
        <intercept-url pattern="/explinkinterface/**" access="permitAll" />
        <intercept-url pattern="/handfeedback/**" access="permitAll" />
        <intercept-url pattern="/orderflow/**" access="permitAll" />
        <intercept-url pattern="/status_feedback/**" access="permitAll" />
        <intercept-url pattern="/test/**" access="permitAll" />
        <intercept-url pattern="/setdefaultexport/**" access="permitAll" />
        <intercept-url pattern="/setexportcwb/**" access="permitAll" />
        <intercept-url pattern="/operation/**" access="permitAll" />
        <intercept-url pattern="/gome/**" access="permitAll" />
        <intercept-url pattern="/amazon/**" access="permitAll" />
        <intercept-url pattern="/b2cjointmonitor/**" access="permitAll" />
        <intercept-url pattern="/OMSChange/**" access="permitAll" />
        <intercept-url pattern="/datastatistics/**" access="permitAll" />
        <intercept-url pattern="/download/**" access="permitAll" />
        <intercept-url pattern="/moonbasa/**" access="permitAll" />
        <intercept-url pattern="/liantong/**" access="permitAll" />
        <intercept-url pattern="/maikaolin/test/**" access="permitAll" />
        <intercept-url pattern="/S_huobang/**" access="permitAll" />
        <intercept-url pattern="/OMSExplink/**" access="permitAll" />
 		<intercept-url pattern="/Ben_lai/**" access="permitAll" />
       <intercept-url pattern="/jiuxianwang/**" access="permitAll"/>
	   <intercept-url pattern="/epaicore/**" access="permitAll"/>
	   <intercept-url pattern="/epainotify/**" access="permitAll"/>
	    <intercept-url pattern="/happygo_oms/**" access="permitAll"/>
 		<intercept-url pattern="/maisike/**" access="permitAll"/>
 		<intercept-url pattern="/sfexpress/**" access="permitAll"/>
 		<intercept-url pattern="/wangjiu/**" access="permitAll" />
 		<intercept-url pattern="/smiled/**" access="permitAll" />
 		<intercept-url pattern="/weisuda/**" access="permitAll" />
 		<intercept-url pattern="/zhongliang/**" access="permitAll" />
	   <intercept-url pattern="/gztlfeedback/**" access="permitAll"/>
	   
	  <intercept-url pattern="/commonemail/**" access="permitAll"/>

        <intercept-url pattern="/**" access="isAuthenticated()" />
		<custom-filter before="FORM_LOGIN_FILTER" ref="loginFilter" />
		<custom-filter position="FORM_LOGIN_FILTER" ref="PDALoginFilter" />
	
		<!-- <custom-filter before="LOGOUT_FILTER" ref="logoutFilter" />
		<custom-filter position="LOGOUT_FILTER" ref="adminLogoutFilter" /> -->
    </http>
    <!-- Configure Authentication mechanism -->
    <authentication-manager alias="authenticationManager">
        <!-- SHA-256 values can be produced using 'echo -n your_desired_password | sha256sum' (using normal *nix environments) -->
        <authentication-provider user-service-ref="userdetailservice">
            <password-encoder  hash="plaintext" />
        </authentication-provider>
    </authentication-manager>
    
    <beans:bean id="userdetailservice" class="cn.explink.service.UserDetailService">
    </beans:bean>
    
    <!-- <beans:bean id="authenticationSuccessHandler" class="cn.explink.jms.ExplinkAuthenticationSuccessHandler"></beans:bean> -->
    
    <beans:bean class="org.springframework.security.core.context.SecurityContextHolder" factory-method="getContextHolderStrategy"/>

	<beans:bean id="loginFilter" class="org.springframework.security.web.authentication.UsernamePasswordAuthenticationFilter">
		<beans:property name="authenticationManager" ref="authenticationManager" />
		<beans:property name="authenticationFailureHandler"	ref="failureHandler" />
		<beans:property name="authenticationSuccessHandler"	ref="successHandler" />
		<beans:property name="filterProcessesUrl" value="/resources/j_spring_security_check" />
	</beans:bean>
	<beans:bean id="failureHandler"	class="org.springframework.security.web.authentication.SimpleUrlAuthenticationFailureHandler">
		<beans:property name="defaultFailureUrl" value="/login?login_error=t" />
	</beans:bean>
	<beans:bean id="successHandler"
		class="cn.explink.jms.ExplinkAuthenticationSuccessHandler">
		<beans:property name="alwaysUseDefaultTargetUrl" value="true" />
		<beans:property name="defaultTargetUrl" value="/" />
	</beans:bean>
    
    
    <beans:bean id="PDALoginFilter" class="org.springframework.security.web.authentication.UsernamePasswordAuthenticationFilter">
		<beans:property name="authenticationManager" ref="authenticationManager" />
		<beans:property name="authenticationFailureHandler" ref="PDAFailureHandler" />
		<beans:property name="authenticationSuccessHandler" ref="PDASuccessHandler" />
		<beans:property name="filterProcessesUrl" value="/resources/j_pda_check" />
	</beans:bean>
	<beans:bean id="PDAFailureHandler" class="org.springframework.security.web.authentication.SimpleUrlAuthenticationFailureHandler">
		<beans:property name="defaultFailureUrl" value="/cwborderPDA/loginError" />
	</beans:bean>
	<beans:bean id="PDASuccessHandler" class="cn.explink.jms.ExplinkAuthenticationSuccessHandler">
		<beans:property name="alwaysUseDefaultTargetUrl" value="true" />
		<beans:property name="defaultTargetUrl" value="/cwborderPDA/login" />
	</beans:bean>
	
	<beans:bean id="http403EntryPoint" class="org.springframework.security.web.authentication.Http403ForbiddenEntryPoint">
    </beans:bean>
	
</beans:beans>